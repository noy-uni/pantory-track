{% extends "base.html" %}

{% block title %}{{ title }} - å–«èŒ¶åº—ç®¡ç†{% endblock %}

{% block content %}

<div class="p-chat-message">
  <div class="p-chat-message__icon">
    <img src="{{ url_for('static', filename='icons/chat-icon.png') }}" alt="ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼">
  </div>
  <div class="p-chat-message__bubble">
    <h1 class="text-2xl font-bold text-amber-900">{{ title }}</h1>
  </div>
</div>
<!-- ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠï¼š2åˆ—ã‚°ãƒªãƒƒãƒ‰ -->
<div class="grid grid-cols-2 gap-5 w-full">
  {% for product in products %}
  <a href="{{ url_for('entry_quantity', mode=mode, product_id=product['id']) }}" 
     class="flex-col bg-white border-2 border-slate-200 rounded-2xl text-slate-800 shadow-sm transition active:scale-95 active:brightness-90 border-b-4 border-b-slate-300 overflow-hidden
            min-height: 240px
     
            {% if product['current_stock'] <= 0 %}
                stock-zero
            {% elif product['reorder_level'] is not none and product['current_stock'] <= product['reorder_level'] %}
                stock-low
            {% endif %}">

    <!-- ç”»åƒã‚¨ãƒªã‚¢ -->
    <div>
      {% if product['image_path'] %}
        <img src="{{ url_for('static', filename='products/' + product['image_path']) }}" 
             alt="{{ product['name'] }}"
             class="w-full h-full object-cover">
      {% else %}
        <!-- emoji wrapper -->
        <div class="w-full h-full flex items-center justify-center bg-slate-50">
          <span class="text-5xl">
            {% if mode == 'arrival' %}âœ¨{% elif mode == 'waste' %}ğŸ¥€{% else %}â˜•{% endif %}
          </span>
        </div>
      {% endif %}
    </div>

    <!-- âœ… å•†å“æƒ…å ±ã‚¨ãƒªã‚¢ -->
    <div class="p-4 flex-1 flex flex-col gap-2">
      <!-- å•†å“å -->
      <div class="font-bold text-xl text-slate-800 leading-tight flex justify-center">{{ product['name'] }}</div>
      
      <!-- è£œè¶³ï¼ˆåŸç”£åœ°ï¼‰ -->
      {% if product['origin'] %}
        <div class="text-base text-slate-500 flex justify-center">ï¼ˆ{{ product['origin'] }}ï¼‰</div>
      {% endif %}
      
      <!-- åœ¨åº«æ•° -->
      <div class="mt-auto pt-2 border-t border-slate-500 flex items-baseline gap-2 justify-center">
        <span class="text-base text-slate-600">åœ¨åº«ï¼š</span>
        <span class="text-2xl font-bold text-amber-600">{{ product['current_stock'] }}</span>
        <span class="text-base text-slate-600">{{ product['unit'] }}</span>
        {% if product['current_stock'] <= 0 %}
          <div class="ml-auto text-sm text-rose-600 font-bold justify-center"">åœ¨åº«ãªã—</div>
        {% endif %}
      </div>
    </div>
  </a>
  {% endfor %}
</div>

<div class="c-footer-nav w-full flex flex-col gap-4 mt-10">
  <a href="{{ url_for('index') }}" class="btn-footer-sub">
    ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
  </a>
</div>

{% endblock %}