{% extends "base.html" %}

{% block title %}数量入力 - 喫茶店管理{% endblock %}

{% block content %}
    <div class="content-wrapper">
        <div class="page-header page-header--{{ mode }}">
            <p class="page-header__mode">{{ title }}</p>
            <h1 class="page-header__product">{{ product['name'] }}</h1>
            {% if product['origin'] %}
                <p class="page-header__origin">（{{ product['origin'] }}）</p>
            {% endif %}
            <p class="page-header__stock">現在の在庫数： {{ product['current_stock'] }}{{ product['unit'] }}</p>
        </div>

        <div class="input-card">
            <form action="/{{ mode }}/execute/{{ product['id'] }}" method="POST">
                <p class="stepper-label">
                  {% if mode == 'arrival' %}
                      いくつ買ってきましたか？
                  {% elif mode == 'waste' %}
                      いくつ捨てますか？
                  {% else %}
                      いくつ使いましたか？
                  {% endif %}
                </p>

                <div class="stepper">
                  <button type="button" class="btn-stepper" onclick="changeQty(-1)" aria-label="数量を減らす">－</button>
                  <input type="number" name="quantity" id="qty" class="qty-display"
                         value="1" min="1" step="1" readonly aria-label="数量">
                  <button type="button" class="btn-stepper" onclick="changeQty(1)" aria-label="数量を増やす">＋</button>
                </div>

                <button type="submit" class="btn-success">
                    {% if mode == 'arrival' %}
                        在庫に追加する
                    {% elif mode == 'waste' %}
                        廃棄を記録する
                    {% else %}
                        使用数を記録する
                    {% endif %}
                </button>
            </form>
        </div>
    </div>

    <div class="c-footer-nav">
      <a href="javascript:history.back()" class="btn-footer-sub">
        前の画面に戻る
      </a>
    </div>
{% endblock %}

{% block scripts %}
<script>
  function changeQty(diff) {
    const qtyInput = document.getElementById('qty');
    let currentVal = parseFloat(qtyInput.value);
    let newVal = currentVal + diff;
    if (newVal < 1) newVal = 1;
    qtyInput.value = newVal.toFixed(1).replace(/\.0$/, '');
  }
</script>
{% endblock %}