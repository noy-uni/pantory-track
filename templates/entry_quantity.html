{% extends "base.html" %}

{% block title %}数量入力 - 喫茶店管理{% endblock %}

{% block content %}
    <p class="text-xl text-amber-800 mb-2 text-center">{{ title }}</p>
    <div class="product-name text-3xl font-bold text-center mb-1">{{ product['name'] }}</div>
    <div class="current-info text-center text-base text-slate-600 mb-4">
      現在：{{ product['current_stock'] }}{{ product['unit'] }}
    </div>

    <div class="input-card mt-6 w-full bg-white rounded-2xl shadow-md p-6 space-y-4">
        <form action="/{{ mode }}/execute/{{ product['id'] }}" method="POST">
            <div class="stepper flex items-center justify-center gap-2 mb-4">
                <button type="button" class="step-btn btn-minus w-12 h-12 flex items-center justify-center rounded-full bg-slate-100 text-2xl font-bold border border-slate-300 active:translate-y-0.5 active:shadow-inner" onclick="changeQty(-1)">－</button>
                <input type="number" name="quantity" id="qty"
                       class="qty-display w-24 text-center text-3xl border border-slate-300 rounded-xl py-1 mx-2 bg-white"
                       value="1" min="1" step="1" readonly>
                <button type="button" class="step-btn btn-plus w-12 h-12 flex items-center justify-center rounded-full bg-slate-100 text-2xl font-bold border border-slate-300 active:translate-y-0.5 active:shadow-inner" onclick="changeQty(1)">＋</button>
            </div>
            
            <p class="text-center text-xl">
              {% if mode == 'arrival' %}
                  買ってきた数
              {% elif mode == 'waste' %}
                  廃棄する数
              {% else %}
                  使い切った数
              {% endif %}
              を選んでください
            </p>

            <button type="submit"
                    class="submit-btn w-full mt-4 rounded-2xl bg-amber-600 text-white font-bold py-3 text-xl shadow-md active:translate-y-0.5 active:shadow-none transition">
                {% if mode == 'arrival' %}
                    在庫に追加する
                {% elif mode == 'waste' %}
                    廃棄する
                {% else %}
                    これで使い切った！
                {% endif %}
            </button>
        </form>
    </div>
    <div class="c-footer-nav w-full flex flex-col gap-4 mt-8">
      <a href="javascript:history.back()"
         class="c-menu-btn c-menu-btn--sub flex items-center justify-center gap-3 w-full py-4 text-2xl font-bold rounded-2xl bg-slate-100 text-slate-900 shadow-sm active:translate-y-1 active:shadow-none transition">
        前の画面に戻る
      </a>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        // ボタンで数字を増減させるスクリプトですわ
        function changeQty(diff) {
            const qtyInput = document.getElementById('qty');
            let currentVal = parseFloat(qtyInput.value);
            let newVal = currentVal + diff;
            if (newVal < 1) newVal = 1; // 1以下にはならないようにする
            qtyInput.value = newVal.toFixed(1).replace(/\.0$/, ''); // 小数点第一位まで。切りのいい時は整数に
        }
    </script>
{% endblock %}