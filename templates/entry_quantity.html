{% extends "base.html" %}

{% block title %}数量入力 - 喫茶店管理{% endblock %}

{% block content %}
    <p>{{ title }}</p>
    <div class="product-name">{{ product['name'] }}</div>
    <div class="current-info">現在：{{ product['current_stock'] }}{{ product['unit'] }}</div>

    <div class="input-card">
        <form action="/{{ mode }}/execute/{{ product['id'] }}" method="POST">
            <div class="stepper">
                <button type="button" class="step-btn btn-minus" onclick="changeQty(-1)">－</button>
                <input type="number" name="quantity" id="qty" class="qty-display" value="1" min="1" step="1" readonly>
                <button type="button" class="step-btn btn-plus" onclick="changeQty(1)">＋</button>
            </div>
            
            <p>
              {% if mode == 'arrival' %}
                  買ってきた数
              {% elif mode == 'waste' %}
                  廃棄する数
              {% else %}
                  使い切った数
              {% endif %}
              を選んでください
            </p>

            <button type="submit" class="submit-btn">
                {% if mode == 'arrival' %}
                    在庫に追加する
                {% elif mode == 'waste' %}
                    廃棄する
                {% else %}
                    これで使い切った！
                {% endif %}
            </button>
        </form>
    </div>

    <a href="javascript:history.back()" class="back-link">← 前の画面に戻る</a>
{% endblock %}

{% block scripts %}
    <script>
        // ボタンで数字を増減させるスクリプトですわ
        function changeQty(diff) {
            const qtyInput = document.getElementById('qty');
            let currentVal = parseFloat(qtyInput.value);
            let newVal = currentVal + diff;
            if (newVal < 1) newVal = 1; // 1以下にはならないようにする
            qtyInput.value = newVal.toFixed(1).replace(/\.0$/, ''); // 小数点第一位まで。切りのいい時は整数に
        }
    </script>
{% endblock %}