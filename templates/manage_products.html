{% extends "base.html" %}

{% block title %}商品管理 - 喫茶店管理{% endblock %}

{% block content %}
    <h1 class="text-2xl font-bold mb-4">✏️ 商品情報の管理</h1>
    
    <div class="text-right mb-4">
        <a href="{{ url_for('add_product') }}" class="text-sm text-amber-700 underline">＋ 新しい商品を登録する</a>
    </div>

    <table class="w-full mt-2 border-collapse bg-white rounded-2xl overflow-hidden shadow-sm text-sm">
        <thead>
            <tr>
                <th class="bg-slate-100 text-left text-xs font-semibold text-slate-700 border-b border-slate-200 px-4 py-2">
                    商品情報
                </th>
                <th class="bg-slate-100 text-left text-xs font-semibold text-slate-700 border-b border-slate-200 px-4 py-2">
                    在庫 / 発注点
                </th>
                <th class="bg-slate-100 text-left text-xs font-semibold text-slate-700 border-b border-slate-200 px-4 py-2">
                    操作
                </th>
            </tr>
        </thead>
        <tbody>
            {% for p in products %}
            <tr class="border-b last:border-0">
                <td class="px-4 py-3 align-top">
                    <span class="badge inline-block rounded-full bg-slate-100 text-slate-600 text-xs px-3 py-1 mb-1">
                        {{ p['category_name'] or '未設定' }}
                    </span><br>
                    <strong class="text-base">{{ p['name'] }}</strong>
                    {% if p['origin'] %}<br><small class="text-slate-500">({{ p['origin'] }})</small>{% endif %}
                </td>
                <td class="px-4 py-3 align-top">
                    在庫: {{ p['current_stock'] }}{{ p['unit'] }}<br>
                    <small class="text-slate-500">発注点: {{ p['reorder_level'] }}</small>
                </td>
                <td class="px-4 py-3 align-top">
                    <div class="flex gap-2">
                        <a href="{{ url_for('edit_product', product_id=p['id']) }}"
                           class="btn-edit inline-flex items-center justify-center rounded-xl bg-amber-500 text-white px-3 py-2 text-xs font-semibold shadow-sm active:translate-y-0.5 active:shadow-none">
                            直す
                        </a>
                        
                        <form action="{{ url_for('delete_product', product_id=p['id']) }}" method="POST" onsubmit="return confirm('本当に削除（非表示に）してもよろしいかしら？');">
                            <button type="submit"
                                    class="btn-delete inline-flex items-center justify-center rounded-xl bg-rose-500 text-white px-3 py-2 text-xs font-semibold shadow-sm active:translate-y-0.5 active:shadow-none">
                                消す
                            </button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="c-footer-nav w-full flex flex-col gap-4 mt-8">
      <a href="{{ url_for('admin_menu') }}"
         class="c-menu-btn c-menu-btn--sub flex items-center justify-center gap-3 w-full py-4 text-xl font-bold rounded-2xl bg-slate-100 text-slate-900 shadow-sm active:translate-y-1 active:shadow-none transition">
        管理メニューに戻る
      </a>
    </div>
{% endblock %}